version: 1.0
runtime: php81
build:
  commands:
    pre-build:
    build:
      - sudo yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm -y
      - sudo yum install https://rpms.remirepo.net/enterprise/remi-release-7.rpm -y
      - sudo yum install yum-utils -y
      - sudo subscription-manager repos --enable=rhel-7-server-optional-rpms -y
      - sudo yum-config-manager --disable 'remi-php*'
      - sudo yum-config-manager --enable   remi-php81
      - sudo yum repolist
      - sudo yum -y install php php-{cli,fpm,mysqlnd,zip,devel,gd,mbstring,curl,xml,pear,bcmath,json,opcache,redis,memcache}
      - yum install gcc -y
      - yum install ImageMagick -y
      - yum install ImageMagick-devel -y
      - pecl install imagick
      - echo "extension=imagick.so" >> /etc/php.ini
run:
  command: php -S 0.0.0.0:3000 -t .
  network:
    port: 3000
    env: APP_PORT
